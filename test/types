#!/usr/bin/env dbqn

EQ â† â‰¡â—‹â€¢HASH
T â† EQâ—¶{â€¢â†"Expected `"âˆ¾(â•ğ•¨)âˆ¾"` and `"âˆ¾(â•ğ•©)âˆ¾"` to be equal"}â€¿âŸ¨âŸ©

CL â† {ğ•©â†‘ËœâŠ‘ğ•©âŠ'.'}âŒ¾âŒ½ â€¢Class

   "BitArr"T CL      0â€¿1
   "BitArr"T CL 0â€¢AS 0â€¿1
   "IntArr"T CL 1â€¢AS 0â€¿1
"DoubleArr"T CL 2â€¢AS 0â€¿1

Tps â† {
  r â† âŸ¨2â€¢AS ğ•©âŸ©
  râˆ¾â†© ğ•¨â—¶{<1â€¢AS ğ•©}â€¿{<1â€¢AS ğ•©}â€¿{(âˆ§Â´0=1|ğ•©)â—¶âŸ¨âŸ©â€¿{<1â€¢AS ğ•©}ğ•©} ğ•©
  râˆ¾â†© ğ•¨â—¶âŸ¨âŸ©       â€¿{<0â€¢AS ğ•©}â€¿{(âˆ§Â´ ğ•©âˆŠâ†•2)â—¶âŸ¨âŸ©â€¿{<0â€¢AS ğ•©}ğ•©} ğ•©
  (âŠ¢â‰¡1âŒ½âŠ¢)â—¶{â€¢â†"failed type conversion"}â€¿âŸ¨âŸ© r
  r
}


â€¢rlâ†0
a0_1 â† 1 Tps â€¢Rand 20â¥Š2
b0_1 â† 1 Tps â€¢Rand 20â¥Š2
ma â† âŸ¨a0_1 â‹„ 2 Tps 5+â€¢Rand 20â¥Š10âŸ©
ta â† (âˆ¾ma) âˆ¾ 2 Tps 5.5+â€¢Rand 20â¥Š10

scd â† "â‹†â¼"<âŠ¸âˆ¾ "+-Ã—Ã·|<â‰¤=â‰¥>â‰ â‹†âˆ¨âˆ§âŒŠâŒˆâˆšÂ¬"
_err â† { Fn _ğ•£:
  # FnâŠ{â€¢â†"ERROR "âˆ¾(â•fn)âˆ¾": "âˆ¾(" "âˆ¾â•ğ•¨)âŠ¢âŠ˜âˆ¾" ğ•Š "âˆ¾â•ğ•© â‹„ "err"}
  FnâŠ"err"
}
# dyadic AA
{ ğ•Š f:
  Fc â† F _err
  r â† a0_1 FcâŒœ b0_1
  c â† r EQÂ¨ <âŠ‘r
  âˆ§Â´âˆ˜â¥Šâ—¶{â€¢â†(â•f)âˆ¾": failed AA"âˆ¾âˆ¾' 'âˆ¾Â¨âˆ¾Â¨<Ë˜â•Â¨ğ•©}â€¿1 c
}Â¨âÂ¨ scd âˆ¾ "/âˆŠâˆ¾â‰âŠ”"


# dyadic As&sA vs AA
{ ğ•Š f:
  { ğ•Š dir:
    Fc â† (dirâŠ‘âŸ¨Fâ‹„FËœâŸ©) _err
    { ğ•Šs:
      { ğ•Šca:
        a â† (â‰ ca) â¥Š s
        (a EQâ—‹(caâŠ¸Fc) s)â—¶{â€¢â†(â•f)âˆ¾": failed scalar "âˆ¾(dirâŠ‘"ğ•©"â€¿"ğ•¨")âˆ¾" â‰¡ "âˆ¾â•s}â€¿âŸ¨âŸ© 0
      }Â¨ ta
    }Â¨ 0â€¿1â€¿2â€¿2.5
  }Â¨ 0â€¿1
}Â¨âÂ¨ scd

# dyadic As & sA vs different types
{ ğ•Š f:
  { ğ•Š dir:
    Fc â† (dirâŠ‘âŸ¨Fâ‹„FËœâŸ©) _err
    ma { a ğ•Š s:
      r â† a FcÂ¨ s
      c â† r EQÂ¨ <âŠ‘r
      âˆ§Â´â—¶{â€¢â†(â•f)âˆ¾": failed scalar "âˆ¾(dirâŠ‘"ğ•©"â€¿"ğ•¨")âˆ¾" â‰¡ "âˆ¾(â•s)âˆ¾"; "âˆ¾(dirâŠ‘"ğ•¨"â€¿"ğ•©")âˆ¾" is"âˆ¾ âˆ¾' 'âˆ¾Â¨ c Â¬âŠ¸/ CLÂ¨ a}â€¿1 c
    }âŒœ 0â€¿1â€¿2â€¿2.5
  }Â¨ 0â€¿1
}Â¨âÂ¨ scd

# monadic
{ ğ•Š f:
  Fc â† F _err
  { ğ•Š a:
    (a EQâ—‹Fc 2â€¢AS a)â—¶{â€¢â†(â•f)âˆ¾": failed monadic "âˆ¾CL a}â€¿âŸ¨âŸ© 0
  }Â¨ ta
}Â¨âŸ¨
  9âŠ¸â†‘, 1000âŠ¸â†‘  â‹„  Â¯9âŠ¸â†‘, Â¯1000âŠ¸â†‘
  9âŠ¸â†“, 1000âŠ¸â†“  â‹„  Â¯9âŠ¸â†“, Â¯1000âŠ¸â†“
  0âŠ¸âˆ¾, 1âŠ¸âˆ¾, 2âŠ¸âˆ¾, 2.5âŠ¸âˆ¾  â‹„  âˆ¾âŸœ0, âˆ¾âŸœ1, âˆ¾âŸœ2, âˆ¾âŸœ2.5
  4â€¿5âŠ¸â¥Š, 100â€¿100âŠ¸â¥Š, 20âŠ¸â¥Š, 10âŠ¸â¥Š, 1000âŠ¸â¥Š
  â‰4â€¿5âŠ¸â¥Š â‹„ <Ë˜4â€¿5âŠ¸â¥Š â‹„ {><Ë˜4â€¿5â¥Šğ•©}
  10âŠ¸âŠ‘ â‹„ (â¥ŠÂ¨3â€¿4)âŠ¸âŠ‘ â‹„ 3âŠ¸âŠ â‹„ 3â€¿4âŠ¸âŠ â‹„ 10â€¿10âŠ¸â¥Š â‹„ âŠâŸœ(â†•20)
  â¥Š, âŒ½, /, âˆŠ, â·, â‹, â’, âŠ”
âŸ© âˆ¾ âÂ¨ "+-Ã—Ã·|=â‰ â‹†âˆ¨âˆ§âŒŠâŒˆâˆšÂ¬"

â